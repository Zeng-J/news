{"version":3,"sources":["utils/index.js","utils/request.js","component/Comment.js","App.js","reportWebVitals.js","index.js"],"names":["utils","formatDate","date","format","yy","Date","getFullYear","mm","getMonth","dd","getDate","hh","getHours","m","getMinutes","ss","getSeconds","ms","getMilliseconds","toLowerCase","replace","dateDiff","timestamp","arrTimestamp","split","start","join","hour","minute","day","diffValue","getTime","monthC","weekC","dayC","hourC","minC","zero","value","parseInt","HEADER","checkStatus","response","status","Error","statusText","parseJSON","text","then","JSON","parse","request","url","obj","fetch","headers","Object","assign","header","postData","method","getData","Comment","props","useState","show","setShow","showReply","setShowReply","replyValue","setReplyValue","timeAgo","data","createdAt","handleShow","children","encodeURI","objectId","res","console","log","results","updateData","catch","err","alert","i","className","onClick","by","onChange","e","target","window","localStorage","getItem","kids","parent","body","stringify","style","marginLeft","map","child","App","content","setContent","userName","setUserName","loading","setLoading","list","setList","handleUpdateData","others","c","useEffect","prompt","setItem","cols","newList","push","item","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"2OAoFA,IAKeA,EALD,CACZC,WArFF,SAAoBC,EAAMC,GAIxB,IAAIC,GADJF,EAAO,IAAIG,KAAKH,IACFI,cACVC,EAAKL,EAAKM,WAAa,EACvBC,EAAKP,EAAKQ,UACVC,EAAKT,EAAKU,WACVC,EAAIX,EAAKY,aACTC,EAAKb,EAAKc,aACVC,EAAKf,EAAKgB,kBAMd,OALAX,EAAKA,EAAK,GAAK,IAAMA,EAAKA,EAC1BE,EAAKA,EAAK,GAAK,IAAMA,EAAKA,EAC1BE,EAAKA,EAAK,GAAK,IAAMA,EAAKA,EAC1BE,EAAIA,EAAI,GAAK,IAAMA,EAAIA,EACvBE,EAAKA,EAAK,GAAK,IAAMA,EAAKA,EACnBZ,EAAOgB,cACTC,QAAQ,KAAMhB,GACdgB,QAAQ,KAAMb,GACda,QAAQ,KAAMX,GACdW,QAAQ,KAAMT,GACdS,QAAQ,IAAKP,GACbO,QAAQ,KAAML,GACdK,QAAQ,KAAMH,IA+DnBI,SA5DF,SAAkBC,GAGhB,IADA,IAAIC,GAAgBD,EAAY,IAAIE,MAAM,IACjCC,EAAQ,EAAGA,EAAQ,GAAIA,IACvBF,EAAaE,KACdF,EAAaE,GAAS,KAG9BH,EAAoC,EAAxBC,EAAaG,KAAK,IAE9B,IACIC,EAAOC,KACPC,EAAa,GAAPF,EAING,GADM,IAAIzB,MAAO0B,UACCT,EAGtB,GAAIQ,EAAY,EACZ,MAAO,qBAIX,IAAIE,EAASF,EAVDD,OAWRI,EAAQH,GAAa,EAAID,GACzBK,EAAOJ,EAAYD,EACnBM,EAAQL,EAAYH,EACpBS,EAAON,EAlBE,IAqBTO,EAAO,SAAUC,GACjB,OAAIA,EAAQ,GACD,IAAMA,EAEVA,GAGX,OAAIN,EAAS,GAED,WACJ,IAAI9B,EAAO,IAAIG,KAAKiB,GACpB,OAAOpB,EAAKI,cAAgB,SAAM+B,EAAKnC,EAAKM,WAAa,GAAK,SAAM6B,EAAKnC,EAAKQ,WAAa,SAFvF,GAIDsB,GAAU,EACVO,SAASP,GAAU,eACnBC,GAAS,EACTM,SAASN,GAAS,eAClBC,GAAQ,EACRK,SAASL,GAAQ,eACjBC,GAAS,EACTI,SAASJ,GAAS,qBAClBC,GAAQ,EACRG,SAASH,GAAQ,qBAErB,iBC/EHI,EAAS,CACb,wBAAyB,mCACzB,sBAAuB,mCACvB,eAAgB,oBAGlB,SAASC,EAAYC,GACnB,GAAIA,EAASC,QAAU,KAAOD,EAASC,OAAS,IAC5C,OAAOD,EAET,MAAM,IAAIE,MAAMF,EAASG,YAI7B,SAASC,EAAUJ,GACjB,OAAOA,GAAYA,EAASK,OAAOC,MAAK,SAAUD,GAC9C,OAAOA,EAAOE,KAAKC,MAAMH,GAAQ,MAIxB,SAASI,EAAQC,EAAKC,GACnC,OAAOC,MAtBO,kCAsBSF,EAAX,YAAC,eACNC,GADK,IAERE,QAASC,OAAOC,OAAOjB,EAAQa,EAAIK,QAAU,OAE9CV,KAAKP,GACLO,KAAKF,GAGH,SAASa,EAASP,EAAKC,GAC5B,OAAOF,EACLC,EADY,YAAC,eAGRC,GAHO,IAIVO,OAAQ,UAKP,SAASC,EAAQT,EAAKC,GAC3B,OAAOF,EACLC,EADY,YAAC,eAGRC,GAHO,IAIVO,OAAQ,S,MCsECE,MA5Gf,SAASA,EAAQC,GAAQ,IAAD,EACEC,oBAAS,GADX,mBACfC,EADe,KACTC,EADS,OAEYF,oBAAS,GAFrB,mBAEfG,EAFe,KAEJC,EAFI,OAGcJ,mBAAS,IAHvB,mBAGfK,EAHe,KAGHC,EAHG,KAKhBC,EAAUvE,EAAMqB,UAAU,IAAIhB,KAAK0D,EAAMS,KAAKC,YAEpD,SAASC,IACFX,EAAMS,KAAKG,UAEdd,EADYe,UAAU,gCAAD,OAAiCb,EAAMS,KAAKK,SAA5C,QAElB7B,MAAK,SAAA8B,GACJC,QAAQC,IAAIF,GACZ,IAAMG,EAAUH,EAAIG,SAAW,GAE/BlB,EAAMmB,WACJnB,EAAMS,KACNS,MAGHE,OAAM,SAAAC,GACLC,MAAM,2CAGZnB,GAAQ,SAAAoB,GAAC,OAAKA,KAoChB,OACE,qBAAKC,UAAU,oBAAf,SACE,sBAAKA,UAAU,UAAf,UACE,qBAAKA,UAAU,eAAeC,QAASd,EAAvC,SACE,qBAAKa,UAAWtB,EAAO,oBAAsB,0BAE/C,sBAAKsB,UAAU,eAAf,UACE,sBAAKA,UAAU,WAAWC,QAASd,EAAnC,UACGX,EAAMS,KAAKiB,GADd,IACmBlB,EACfN,EAAsE,KAA/D,sBAAMsB,UAAU,oBAAhB,SAAqCxB,EAAMS,KAAKzB,UAE3D,sBAAKwC,UAAS,sBAAiBtB,EAAO,mBAAqB,IAA3D,UACE,qBAAKsB,UAAU,kBAAf,SACGxB,EAAMS,KAAKzB,OAEd,qBAAKwC,UAAU,gBAAf,SAEIpB,EAEI,gCACE,uBAAO7B,MAAO+B,EAAYqB,SAAU,SAAAC,GAAC,OAAIrB,EAAcqB,EAAEC,OAAOtD,UAChE,wBAAQkD,QAtD5B,WACE,GAAKnB,EAAL,CAIA,IAAMG,EAAO,CACXiB,GAAII,OAAOC,aAAaC,QAAQ,YAChCC,KAAM,GACNC,OAAQlC,EAAMS,KAAKK,SACnB9B,KAAMsB,GAGRV,EAAS,cAAe,CACtBuC,KAAMjD,KAAKkD,UAAU3B,KACpBxB,MAAK,SAAA8B,GACNV,GAAa,GACbE,EAAc,IAEdP,EAAMmB,WACJnB,EAAMS,KACN,CAAC,2BACIA,GADL,IAEEG,SAAU,GACVE,SAAUC,EAAID,SACdJ,UAAWK,EAAIL,iBAIlBU,OAAM,SAAAC,GACPC,MAAM,iCAyBuCe,MAAO,CAAEC,WAAY,IAAlD,0BACA,wBAAQb,QAAS,kBAAMpB,GAAa,IAAQgC,MAAO,CAAEC,WAAY,IAAjE,6BAGF,mBAAGb,QAAS,kBAAMpB,GAAa,IAA/B,4BAGR,qBAAKmB,UAAU,cAAf,SAEIxB,EAAMS,KAAKG,UAAYZ,EAAMS,KAAKG,SAAS2B,KAAI,SAAAC,GAC7C,OACE,cAAC,EAAD,CACE/B,KAAM+B,EAENrB,WAAYnB,EAAMmB,YADbqB,EAAM1B,2B,MCMlB2B,MApGf,WAAgB,IAAD,EACgBxC,mBAAS,IADzB,mBACPyC,EADO,KACEC,EADF,OAEkB1C,mBAAS,IAF3B,mBAEP2C,EAFO,KAEGC,EAFH,OAGgB5C,oBAAS,GAHzB,mBAGP6C,EAHO,KAGEC,EAHF,OAIU9C,mBAAS,IAJnB,mBAIP+C,EAJO,KAIDC,EAJC,KA8Dd,SAASC,EAAiBhB,EAAQiB,GACjCjB,EAAOtB,SAAWsB,EAAOtB,UAAY,GACrCsB,EAAOtB,SAAP,sBAAsBsB,EAAOtB,UAA7B,YAA0CuC,IAC1CF,GAAQ,SAAAG,GAAC,OAAIlE,KAAKC,MAAMD,KAAKkD,UAAUgB,OAGxC,OAlDAC,qBAAU,WACT,IAAMT,EAAWU,OAAO,0DACxBxB,OAAOC,aAAawB,QAAQ,WAAYX,GAAY,QACpDC,EAAYD,GAbZ9C,EAAQ,WACNb,MAAK,SAAA8B,GACL,IAAMG,EAAUH,EAAIG,SAAW,GAC/B+B,EAAQ/B,MAERE,OAAM,SAAAC,GACNC,MAAM,6CASN,IA8CF,sBAAKE,UAAU,MAAf,UACC,yBAAQA,UAAU,aAAlB,UACC,qBAAKA,UAAU,WAAf,SACC,+BAAOoB,MAER,0BACCrE,MAAOmE,EACPf,SAAU,SAAAC,GAAC,OAAIe,EAAWf,EAAEC,OAAOtD,QACnCiF,KAAK,OAEN,qBAAKhC,UAAU,uBAAf,SACC,wBAAQC,QAvDZ,WACC,GAAKiB,IAAWI,EAAhB,CAIA,IAAMrC,EAAO,CACZiB,GAAII,OAAOC,aAAaC,QAAQ,YAChCC,KAAM,GACNjD,KAAM0D,GAGPK,GAAW,GAEXnD,EAAS,UAAW,CACnBuC,KAAMjD,KAAKkD,UAAU3B,KACnBxB,MAAK,SAAA8B,GACP4B,EAAW,IAEXM,GAAQ,SAAAG,GACP,IAAIK,EAAUvE,KAAKC,MAAMD,KAAKkD,UAAUgB,IAQxC,OAPAK,EAAQC,KAAR,2BACIjD,GADJ,IAECG,SAAU,GACVE,SAAUC,EAAID,SACdJ,UAAWK,EAAIL,aAEhBM,QAAQC,IAAIwC,EAAS1C,GACd0C,KAGRV,GAAW,MAET3B,OAAM,SAAAC,GACRC,MAAM,6CAsBJ,2CAGF,qBAAKE,UAAU,eAAf,SAEEwB,EAAKT,KAAI,SAAAoB,GACR,OACC,cAAC,EAAD,CACClD,KAAMkD,EAENxC,WAAY+B,GADPS,EAAK7C,mBCrFH8C,EAZS,SAAAC,GAClBA,GAAeA,aAAuBC,UACxC,6BAAqB7E,MAAK,YAAkD,IAA/C8E,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOF,GACPG,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAQN,OCDdO,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEFC,SAASC,eAAe,SAM1BZ,M","file":"static/js/main.90beae65.chunk.js","sourcesContent":["function formatDate(date, format) {\n  /**** utils.formatDate(value, \"YY-MM-DD hh:m:ss\") ****/\n\n  date = new Date(date);\n  let yy = date.getFullYear();\n  let mm = date.getMonth() + 1;\n  let dd = date.getDate();\n  let hh = date.getHours();\n  let m = date.getMinutes();\n  let ss = date.getSeconds();\n  let ms = date.getMilliseconds();\n  mm = mm < 10 ? \"0\" + mm : mm;\n  dd = dd < 10 ? \"0\" + dd : dd;\n  hh = hh < 10 ? '0' + hh : hh;\n  m = m < 10 ? '0' + m : m;\n  ss = ss < 10 ? '0' + ss : ss;\n  return format.toLowerCase()\n      .replace('yy', yy)\n      .replace('mm', mm)\n      .replace('dd', dd)\n      .replace('hh', hh)\n      .replace('m', m)\n      .replace('ss', ss)\n      .replace('ms', ms);\n};\n\nfunction dateDiff(timestamp) {\n  // 补全为13位\n  var arrTimestamp = (timestamp + '').split('');\n  for (var start = 0; start < 13; start++) {\n      if (!arrTimestamp[start]) {\n          arrTimestamp[start] = '0';\n      }\n  }\n  timestamp = arrTimestamp.join('') * 1;\n\n  var minute = 1000 * 60;\n  var hour = minute * 60;\n  var day = hour * 24;\n  var halfamonth = day * 15;\n  var month = day * 30;\n  var now = new Date().getTime();\n  var diffValue = now - timestamp;\n\n  // 如果本地时间反而小于变量时间\n  if (diffValue < 0) {\n      return '不久前';\n  }\n\n  // 计算差异时间的量级\n  var monthC = diffValue / month;\n  var weekC = diffValue / (7 * day);\n  var dayC = diffValue / day;\n  var hourC = diffValue / hour;\n  var minC = diffValue / minute;\n\n  // 数值补0方法\n  var zero = function (value) {\n      if (value < 10) {\n          return '0' + value;\n      }\n      return value;\n  };\n\n  if (monthC > 12) {\n      // 超过1年，直接显示年月日\n      return (function () {\n          var date = new Date(timestamp);\n          return date.getFullYear() + '年' + zero(date.getMonth() + 1) + '月' + zero(date.getDate()) + '日';\n      })();\n  } else if (monthC >= 1) {\n      return parseInt(monthC) + \"月前\";\n  } else if (weekC >= 1) {\n      return parseInt(weekC) + \"周前\";\n  } else if (dayC >= 1) {\n      return parseInt(dayC) + \"天前\";\n  } else if (hourC >= 1) {\n      return parseInt(hourC) + \"小时前\";\n  } else if (minC >= 1) {\n      return parseInt(minC) + \"分钟前\";\n  }\n  return '刚刚';\n};\n\nconst utils = {\n  formatDate,\n  dateDiff,\n}\n\nexport default utils;","\nconst API_URL = 'https://api2.bmob.cn/1/classes/';\nconst HEADER = {\n  'X-Bmob-Application-Id': '089df87a586aac761a2feb9dbfbb0d7d',\n  'X-Bmob-REST-API-Key': '5fcfb2bff65fa11220ba356839008e21',\n  'Content-Type': 'application/json',\n}\n\nfunction checkStatus(response) {\n  if (response.status >= 200 && response.status < 300) {\n      return response;\n  } else {\n    throw new Error(response.statusText);\n  }\n}\n\nfunction parseJSON(response) {\n  return response && response.text().then(function (text) {\n      return text ? JSON.parse(text) : {}\n  })\n}\n\nexport default function request(url, obj) {\n  return fetch(API_URL + url, {\n      ...obj,\n      headers: Object.assign(HEADER, obj.header || {}),\n    })\n    .then(checkStatus)\n    .then(parseJSON)\n}\n\nexport function postData(url, obj) {\n  return request(\n    url, \n    {\n      ...obj,\n      method: 'POST',\n    }\n  )\n}\n\nexport function getData(url, obj) {\n  return request(\n    url, \n    {\n      ...obj,\n      method: 'GET',\n    }\n  )\n}","import { useState } from 'react';\n\nimport utils from '../utils/index';\n\nimport { getData, postData } from '../utils/request';\n\nimport './Comment.css';\n\nfunction Comment(props) {\n  const [show, setShow] = useState(false);\n  const [showReply, setShowReply] = useState(false);\n  const [replyValue, setReplyValue] = useState('');\n\n  const timeAgo = utils.dateDiff(+new Date(props.data.createdAt));\n\n  function handleShow() {\n    if (!props.data.children) {\n      const url = encodeURI(`sub_comment?where={\"parent\":\"${props.data.objectId}\"}`);\n      getData(url)\n        .then(res => {\n          console.log(res)\n          const results = res.results || [];\n\n          props.updateData(\n            props.data,\n            results\n          );\n        })\n        .catch(err => {\n          alert('获取数据失败')\n        })\n    }\n    setShow(i => !i);\n  }\n\n  function handleSend() {\n    if (!replyValue) {\n      return;\n    }\n\n    const data = {\n      by: window.localStorage.getItem('userName'),\n      kids: [],\n      parent: props.data.objectId,\n      text: replyValue,\n    }\n\n    postData('sub_comment', {\n      body: JSON.stringify(data)\n    }).then(res => {\n      setShowReply(false);\n      setReplyValue('');\n\n      props.updateData(\n        props.data,\n        [{\n          ...data,\n          children: [],\n          objectId: res.objectId,\n          createdAt: res.createdAt,\n        }]\n      );\n\n    }).catch(err => {\n      alert('回复失败')\n    })\n  }\n\n  return (\n    <div className=\"comment-list-item\">\n      <div className=\"comment\">\n        <div className=\"comment-left\" onClick={handleShow}>\n          <div className={show ? 'comment-left_show' : 'comment-left_hidden'}></div>\n        </div>\n        <div className=\"comment-main\">\n          <div className=\"meta-box\" onClick={handleShow}>\n            {props.data.by} {timeAgo}\n            {!show ? <span className=\"meta-box_ellipsis\">{props.data.text}</span> : null}\n          </div>\n          <div className={`comment-box ${show ? 'comment-box_show' : ''}`}>\n            <div className=\"comment-content\">\n              {props.data.text}\n            </div>\n            <div className=\"comment-reply\">\n              {\n                showReply\n                  ? (\n                    <div>\n                      <input value={replyValue} onChange={e => setReplyValue(e.target.value)} />\n                      <button onClick={handleSend} style={{ marginLeft: 10 }}>发送</button>\n                      <button onClick={() => setShowReply(false)} style={{ marginLeft: 10 }}>取消</button>\n                    </div>\n                  )\n                  : <a onClick={() => setShowReply(true)}>回复</a>\n              }\n            </div>\n            <div className=\"sub-comment\">\n              {\n                props.data.children && props.data.children.map(child => {\n                  return (\n                    <Comment\n                      data={child}\n                      key={child.objectId}\n                      updateData={props.updateData}\n                    />\n                  );\n                })\n              }\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default Comment;\n","import { useState, useEffect } from 'react';\n\nimport Comment from './component/Comment';\n\nimport { getData, postData } from './utils/request';\n\nimport './App.css';\n\nfunction App() {\n\tconst [content, setContent] = useState('');\n\tconst [userName, setUserName] = useState('');\n\tconst [loading, setLoading] = useState(false);\n\tconst [list, setList] = useState([]);\n\n\n\tfunction getDataList() {\n\t\tgetData('comment')\n\t\t\t.then(res => {\n\t\t\t\tconst results = res.results || [];\n\t\t\t\tsetList(results)\n\t\t\t})\n\t\t\t.catch(err => {\n\t\t\t\talert('获取数据失败')\n\t\t\t})\n\t}\n\n\tuseEffect(() => {\n\t\tconst userName = prompt('请输入您喜欢的昵称');\n\t\twindow.localStorage.setItem('userName', userName || 'user');\n\t\tsetUserName(userName);\n\t\tgetDataList();\n\t}, [])\n\n\tfunction addComment() {\n\t\tif (!content || loading) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst data = {\n\t\t\tby: window.localStorage.getItem('userName'),\n\t\t\tkids: [],\n\t\t\ttext: content,\n\t\t}\n\n\t\tsetLoading(true);\n\n\t\tpostData('comment', {\n\t\t\tbody: JSON.stringify(data)\n\t\t}).then(res => {\n\t\t\tsetContent('');\n\n\t\t\tsetList(c => {\n\t\t\t\tlet newList = JSON.parse(JSON.stringify(c));\n\t\t\t\tnewList.push({\n\t\t\t\t\t...data,\n\t\t\t\t\tchildren: [],\n\t\t\t\t\tobjectId: res.objectId,\n\t\t\t\t\tcreatedAt: res.createdAt,\n\t\t\t\t});\n\t\t\t\tconsole.log(newList, res)\n\t\t\t\treturn newList;\n\t\t\t});\n\n\t\t\tsetLoading(false);\n\n\t\t}).catch(err => {\n\t\t\talert('添加评论失败')\n\t\t})\n\t}\n\n\tfunction handleUpdateData(parent, others) {\n\t\tparent.children = parent.children || [];\n\t\tparent.children = [...parent.children, ...others];\n\t\tsetList(c => JSON.parse(JSON.stringify(c)));\n\t}\n\n\treturn (\n\t\t<div className=\"App\">\n\t\t\t<header className=\"App-header\">\n\t\t\t\t<div className=\"user-box\">\n\t\t\t\t\t<span>{userName}</span>\n\t\t\t\t</div>\n\t\t\t\t<textarea\n\t\t\t\t\tvalue={content}\n\t\t\t\t\tonChange={e => setContent(e.target.value)}\n\t\t\t\t\tcols=\"50\"\n\t\t\t\t/>\n\t\t\t\t<div className=\"App-header-operation\">\n\t\t\t\t\t<button onClick={addComment}>添加评论</button>\n\t\t\t\t</div>\n\t\t\t</header>\n\t\t\t<div className=\"comment-list\">\n\t\t\t\t{\n\t\t\t\t\tlist.map(item => {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<Comment\n\t\t\t\t\t\t\t\tdata={item}\n\t\t\t\t\t\t\t\tkey={item.objectId}\n\t\t\t\t\t\t\t\tupdateData={handleUpdateData}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t);\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}